<!-- SETUP -->
## SETUP

Thank you for visiting my repo. To ensure you have the proper packages run the following commands to 
set up a virtual environment.

  ```sh
  conda env create -f environment.yml
  conda activate qualoffer
  ```


<!-- GETTING STARTED -->
## Getting Started

In this repo you will find 5 seperate python files:

- main.py
- plotter.py
- dataframe_functions.py
- get_player_data.py
- link_to_dataframe.py

main.py is meant to be the point of execution of the program.
The other files are intended to be wrappers/functions that are called upon from the main.py file

_Below is an introduction of the functions each helper file provides to main.py_

### link_to_dataframe.py

The main purpose of this file is to scrape the data from the link that was provided and 
convert it into a pandas dataframe. The functions are listed below:

  ```sh
  link_to_dataframe(link, fill_in_missing_data, check_for_data_disparity)
  ```
link_to_dataframe() takes 3 arguments:
* __link__ - _this would be the web link to the dataset_
* __fill_in_missing_data__ - _when scraping the provided link, if there in a missing or Null value for salary, the program will make a request to Baseball-Reference.com to find the value there. Set to True or False_
* __check_for_data_disparity__ - _the salary of every player in the dataset will be compared to the listed value on Baseball-Reference.com, a flag will be raised if they are significantly different. Set to True or False_

The function returns a dataframe object

__warning__: enabling fill_in_missing_data or check_for_data_disparity significantly slows down runtime


  ```sh
  check_salary_disparity(player_name, player_year, player_original_salary)
  ```
check_salary_disparity() takes 3 arguments:
* __player_name__ - _format: "Lastname, Firstname" type: string_
* __player_year__ - _type: int_
* __player_original_salary__ - _this would be the value from our dataset, which will be checked against Baseball-Reference.com, format: int_

The function will return True if the value for salary is significantly greater between the given dataset and Baseball-Reference.com.

  ```sh
  find_salary(player_name, player_year)
  ```
find_salary() takes 2 arguments:
* __player_name__ - _format: "Lastname, Firstname" type: string_
* __player_year__ - _type: int_

The function will return the listed salary of the player on Baseball-Reference.com for the given year.



### get_player_data.py

The main purpose of this file is to find the respective Baseball-Reference.com page for a given player and scrape the data we desire.

  ```sh
  get_player_page(find_player_name, current_year)
  ```
get_player_page() takes 2 arguments:
* __find_player_name__ - _format: "Lastname, Firstname" type: string_
* __current_year__ - _type: int_

The function returns the link to the player's Baseball-Reference.com page

  ```sh
  extract_data_from_link(link, current_year)
  ```
extract_data_from_link() takes 2 arguments:
* __link__ - _link to player's baseball-reference.com page_
* __current_year__ - _type: int_

The function scrapes data from the website and returns it in JSON format

 ```sh
  get_stats_from_name(player_name, current_year)
  ```
get_stats_from_name() takes 2 arguments:
* __player_name__ - _format: "Lastname, Firstname" type: string_
* __current_year__ - _type: int_

The function returns the player's statistics in JSON format


### dataframe_functions.py

The main purpose of this file is to provide functions which preform operations on a pandas dataframe

  ```sh
  sort_by_salary(df)
  ```
sort_by_salary() takes 1 argument:
* __df__ - _pandas dataframe that is generated by link_to_dataframe()_

The function returns the dataframe but sorted by salary


  ```sh
  average_salary(df)
  ```
average_salary() takes 1 argument:
* __df__ - _pandas dataframe_

The function returns the average salary of all players in the dataframe


  ```sh
  nth_largest(df, n)
  ```
nth_largest() takes 1 argument:
* __df__ - _pandas dataframe that is generated by link_to_dataframe()_

The function returns the dataframe but shortened to only the top n values

### plotter.py

The main purpose of this file is to provide visualization functions for the dataframe

  ```sh
  salary_war_plot(df)
  ```
salary_war_plot() takes 1 argument:
* __df__ - _pandas dataframe that is generated by link_to_dataframe()_

The function returns a matplotlib scatter plot of player's salary vs war

  ```sh
  salary_position_plot(df)
  ```
salary_position_plot() takes 1 argument:
* __df__ - _pandas dataframe that is generated by link_to_dataframe()_

The function returns a matplotlib bar graph of the defensive positions that appear in the dataframe


  ```sh
  salary_histogram(df)
  ```
salary_position_plot() takes 1 argument:
* __df__ - _pandas dataframe that is generated by link_to_dataframe()_

The function returns matplotlib histogram of the salaries within the dataframe

<!-- GETTING STARTED -->
## USING THE SHELL

If you want to run command lines from the terminal you must first import the necessary packages

 ```sh
   from plotter import *
   from link_to_dataframe import link_to_dataframe
   from dataframe_functions import *
  ```
The next step is to define the link to the dataset
 ```sh
   link = "https://questionnaire-148920.appspot.com/swe/data.html"
  ```

From here you can generate a pandas dataframe
 ```sh
    df = link_to_dataframe(link=link, fill_in_missing_data=False, check_for_data_disparity = False)
  ```

Once the dataframe is defined you can run any of the above commands to manipulate or run the data

<!-- GETTING STARTED -->
## DISCUSSION

What I'm proud of:
* There were many missing values for salary in the dataset. I noticed that if you 
refresh the page, sometimes the values will load. Instead of constantly making a request 
  to the same page, I built in functionality that looks for the value on Baseball-Reference.com, 
  this adds an extra level of robustness to the model
  

* I'm proud of the loading feature that is printed out to the command line to show the status of the program.
When dealing with large datasets or computationally intensive tasks, it can be frustrating when the program hangs
  with no indication of it ending.
  

* I'm proud of the modularity of all my functions. All the plot files simply take in a dataframe with no
configuration necessary. 
  

* I'm really proud of the get_stats_from_name() function. This allows me to find the age, war, position of any player.


What I would improve if given more time:

* Whenever the function get_stats_from_name() is called, it makes a request to Basball-Reference.com which returns an HTML file
which then needs to be parsed. If I had more time I would have made a simple on-disk database that stores
  all the information needed for the players in the dataset. This would make recall much more efficient.
  
* I ended up just using matplotlib for data visualization but if I had more time, I would use a more interactive
UI such as streamlit.io. This would be very helpful for non-developers to work with the data
  
* There are a few players in MLB that have the same first name and last name. This was the case with the given dataset.
The only differentiator available in the dataset was the salary so it was hard to tell which player played for what team.
  In the future I would either devise my own player_id or I would request it from the owner of the dataset.
  

<!-- GETTING STARTED -->
## RESOURCES

Thanks to:
* https://www.baseball-reference.com/
* https://www.crummy.com/software/BeautifulSoup/bs4/doc/
* https://pandas.pydata.org/docs/